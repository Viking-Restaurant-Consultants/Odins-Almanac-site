<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Odin's Almanac Dashboard - Working</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: white;
            font-family: Arial, sans-serif;
            min-height: 100vh;
            padding: 20px;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .title {
            font-size: 2.5rem;
            font-weight: bold;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #FFD700, #FFA500);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .metric-card {
            background: white;
            color: #333;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }
        
        .metric-value {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .revenue { color: #10B981; }
        .cost { color: #F59E0B; }
        .labor { color: #EF4444; }
        .profit { color: #8B5CF6; }
        
        .buttons {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .btn {
            padding: 15px 25px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }
        
        .btn-gold {
            background: linear-gradient(45deg, #FFD700, #FFA500);
            color: #1a1a2e;
        }
        
        .btn-blue {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
        }
        
        .btn-green {
            background: #10B981;
            color: white;
        }
        
        .message {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            border-left: 4px solid #FFD700;
        }
        
        .working-indicator {
            background: #10B981;
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            display: inline-block;
            margin: 10px 0;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1 class="title">‚öîÔ∏è Odin's Almanac</h1>
        <p>Restaurant Intelligence Platform</p>
        <div class="working-indicator">‚úÖ Dashboard Status: WORKING</div>
    </div>
    
    <div class="metrics">
        <div class="metric-card">
            <div class="metric-value revenue" id="revenue">$45,250</div>
            <div>Monthly Revenue</div>
            <small>Updates every 10 seconds</small>
        </div>
        
        <div class="metric-card">
            <div class="metric-value cost">28.5%</div>
            <div>Food Cost</div>
            <small>Target: 30%</small>
        </div>
        
        <div class="metric-card">
            <div class="metric-value labor">32.8%</div>
            <div>Labor Cost</div>
            <small>Target: 30%</small>
        </div>
        
        <div class="metric-card">
            <div class="metric-value profit" id="profit">$8,745</div>
            <div>Net Profit</div>
            <small>19.3% margin</small>
        </div>
    </div>
    
    <div class="buttons">
        <button class="btn btn-gold" onclick="updateNow()">üîÑ Update Metrics</button>
        <button class="btn btn-blue" onclick="goToPricing()">üí∞ View Pricing</button>
        <button class="btn btn-green" onclick="testStripe()">üí≥ Test Stripe</button>
        <button class="btn btn-gold" onclick="showFeatures()">üöÄ Show Features</button>
    </div>
    
    <div id="messages"></div>
    
    <div class="message">
        <strong>üéØ Dashboard Features:</strong><br>
        ‚úÖ Real-time metrics updates<br>
        ‚úÖ Stripe payment integration<br>
        ‚úÖ Navigation to pricing page<br>
        ‚úÖ Viking-themed design system<br>
    </div>
    
    <script>
        console.log('üöÄ Dashboard loading...');
        
        let updateCount = 0;
        
        function showMessage(text, type = 'info') {
            const messages = document.getElementById('messages');
            const msg = document.createElement('div');
            msg.className = 'message';
            msg.innerHTML = text;
            messages.appendChild(msg);
            
            setTimeout(() => {
                if (messages.contains(msg)) {
                    messages.removeChild(msg);
                }
            }, 5000);
        }
        
        function updateNow() {
            const revenue = document.getElementById('revenue');
            const profit = document.getElementById('profit');
            
            const newRevenue = 40000 + Math.floor(Math.random() * 15000);
            const newProfit = Math.floor(newRevenue * (0.15 + Math.random() * 0.1));
            
            revenue.textContent = '$' + newRevenue.toLocaleString();
            profit.textContent = '$' + newProfit.toLocaleString();
            
            updateCount++;
            showMessage(`‚öîÔ∏è Odin's Eye Update #${updateCount}: Revenue ${newRevenue.toLocaleString()}, Profit ${newProfit.toLocaleString()}`);
            
            console.log('Metrics updated:', newRevenue, newProfit);
        }
        
        function goToPricing() {
            showMessage('üèÉ‚Äç‚ôÇÔ∏è Navigating to pricing page...');
            setTimeout(() => {
                window.location.href = '/pricing.html';
            }, 1000);
        }
        
        function testStripe() {
            showMessage('üîÑ Testing Stripe integration...');
            
            fetch('/api/create-checkout-session', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    priceId: 'price_1QJiGLRrAdNPc20oDqzsbyEI',
                    mode: 'subscription'
                })
            })
            .then(response => response.json())
            .then(data => {
                if (data.url) {
                    showMessage('‚úÖ Stripe working! Checkout URL ready. Click to proceed to payment.');
                    setTimeout(() => window.location.href = data.url, 2000);
                } else {
                    showMessage('‚ùå Stripe test failed - no URL returned');
                }
            })
            .catch(error => {
                showMessage('‚ùå Stripe error: ' + error.message);
            });
        }
        
        function showFeatures() {
            showMessage(`
                üéØ <strong>Available Features:</strong><br>
                üìä P&L Analysis & Metrics<br>
                üí∞ Stripe Subscription System<br>
                ü§ñ AI-Powered Insights<br>
                üì± Mobile-Responsive Design<br>
                ‚öîÔ∏è Viking Theme & Branding
            `);
        }
        
        // Auto-update every 10 seconds
        setInterval(() => {
            updateNow();
        }, 10000);
        
        // Welcome message
        setTimeout(() => {
            showMessage('‚öîÔ∏è Welcome to Odin\'s Almanac! All systems operational.');
        }, 1000);
        
        console.log('‚úÖ Dashboard loaded successfully!');
    </script>
</body>
</html>